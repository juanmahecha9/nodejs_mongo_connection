{"version":3,"sources":["../../../src/lib/functions/jsontoexcel.convert.js"],"names":["convertToExcel","data","EXCEL_TYPE","EXCEL_EXTENSION","worksheet","XLSX","utils","json_to_sheet","workbook","Sheets","SheetNames","excelBuffer","write","bookType","type","console","log","saveAsExcel","Buffer","filename","Blob","saveAs","Date","getTime","module","exports"],"mappings":";;AAAA;;;;AAEA,MAAMA,cAAc,GAAIC,IAAD,IAAU;AAC/B,QAAMC,UAAU,GAAG,gFAAnB;AACA,QAAMC,eAAe,GAAG,MAAxB;;AAEA,QAAMC,SAAS,GAAGC,cAAKC,KAAL,CAAWC,aAAX,CAAyBN,IAAzB,CAAlB;;AACA,QAAMO,QAAQ,GAAG;AACbC,IAAAA,MAAM,EAAE;AACJ,cAAQL;AADJ,KADK;AAIbM,IAAAA,UAAU,EAAE,CAAC,MAAD;AAJC,GAAjB;;AAMA,QAAMC,WAAW,GAAGN,cAAKO,KAAL,CAAWJ,QAAX,EAAqB;AAAEK,IAAAA,QAAQ,EAAE,MAAZ;AAAoBC,IAAAA,IAAI,EAAE;AAA1B,GAArB,CAApB;;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYL,WAAZ;AACAM,EAAAA,WAAW,CAACN,WAAD,EAAc,MAAd,CAAX;AACD,CAdD;;AAgBA,SAASM,WAAT,CAAsBC,MAAtB,EAA8BC,QAA9B,EAAuC;AACnC,QAAMlB,IAAI,GAAG,IAAImB,IAAJ,CAAS,CAACF,MAAD,CAAT,EAAmB;AAACJ,IAAAA,IAAI,EAAE;AAAP,GAAnB,CAAb;AACAO,EAAAA,MAAM,CAACpB,IAAD,EAAMkB,QAAQ,GAAC,UAAT,GAAoB,IAAIG,IAAJ,GAAWC,OAAX,EAApB,GAAyCpB,eAA/C,CAAN;AACH;;AACDqB,MAAM,CAACC,OAAP,GAAiBzB,cAAjB","sourcesContent":["import XLSX from \"xlsx\";\n\nconst convertToExcel = (data) => {\n  const EXCEL_TYPE = 'applicarion/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF8'\n  const EXCEL_EXTENSION = 'xlsx'\n\n  const worksheet = XLSX.utils.json_to_sheet(data)\n  const workbook = {\n      Sheets: {\n          'data': worksheet\n      },\n      SheetNames: ['data']\n  }\n  const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'xlsx'})\n  console.log(excelBuffer)\n  saveAsExcel(excelBuffer, \"file\")\n};\n\nfunction saveAsExcel (Buffer, filename){\n    const data = new Blob([Buffer], {type: \"EXCEL_TYPE\"})\n    saveAs(data,filename+'_export_'+new Date().getTime()+EXCEL_EXTENSION)\n}\nmodule.exports = convertToExcel;\n"],"file":"jsontoexcel.convert.js"}